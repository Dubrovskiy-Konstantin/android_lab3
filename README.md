# Медиаплеер

---

В ходе лабораторной работы №3 было разработано приложение-плеер. 
Приложение предусмотрено для работы как с аудио, так и с видео одновременно. 

По-задумке приложение после запуска должно было ожидать от пользователя выбора файлов
(аудио- или видео-), затем динамически добавлять их в список воспроизведения. 
(Выглядит это так: пользователь накидал в очередь файлов, а затем свайпами
проходит по списку)

Для этого было решено использовать _фрагменты_ и компонент _ViewPager2_.
Для компонента был написан собственный адаптер [FragmentAdapter](./java/com/example/mediaplayer/FragmentAdapter.kt), работающий со списком фрагментов.
Необходимо было реализовать разные функции у фрагментов видео и аудио. Для этого
был создан класс-родитель [PageFragment](./java/com/example/mediaplayer/PageFragment.kt)
(реализует класс Fragment), экземпляры которого хранит адаптер, и классы-наследники
[PageAudioFragment](./java/com/example/mediaplayer/PageAudioFragment.kt) и
[PageVideoFragment](./java/com/example/mediaplayer/PageVideoFragment.kt), 
которые уже непосредственно реализуют методы родительского PageFragment.

Все фрагменты автоматически воспроизводят медиа, по свайпу предыдущий останавливается, 
а следующий начинает воспроизводиться. Данные позиции сохраняются, поэтому по свайпу назад
начинается воспроизведение с остановленного момента у предыдущего.

---
Video
---
Для работы с видео использовался компонент _VideoView_.
Для воспроизведения достаточно передать ему Uri файла. Для плей/паузы, 
перемотки использовался встроенный компонент _MediaController_. 
Возникло желание переопределить его добавить кнопку для полного экрана 
и обработчик ее нажатия. Это реализовано в классе [CustomMediaController](./java/com/example/mediaplayer/CustomMediaController.java).
За полный экран отвечает [FullScreenActivity](./java/com/example/mediaplayer/FullScreenActivity.kt).
Режим по умолчанию открывается в landscape ориентации. На нем ничего лишнего.

В качестве эксклюзивной опции в полноэкранном режиме реализована 
промотка +-10 сек по _двойному клику_ в соответствующей части экрана.

Текущая позиция в видео не теряется при переходе в полный экран и обратно.



---
Audio
---

Для возможности воспроизводить аудио в фоновом режиме, оно воспроизводится сразу в службе 
[MediaService](./java/com/example/mediaplayer/MediaService.kt).
Одновременно с этим показывается уведомление о проигрываемом файле.
Уведомление также содержит _кнопку_, которая останавливает музыку.
За управление уведомлением и кнопкой отвечает класс [NotificationHandler](./java/com/example/mediaplayer/NotificationHandler.kt).
Он создает уведомление и запускает службу отслеживания этой кнопки (служба NotificationActionService, описанная внутри этого класса), 
которая прекращает воспроизведение.

---

Оставшаяся навигация:
- класс [MainActivity](./java/com/example/mediaplayer/MainActivity.kt)
- layout мэйна [activity_main](./res/layout/activity_main.xml)
- layout аудио фрагмента [audio_fragment_page](./res/layout/audio_fragment_page.xml)
- layout видео фрагмента [video_fragment_page](./res/layout/video_fragment_page.xml)
- layout полного экрана [activity_full_screen](./res/layout/activity_full_screen.xml)
- файл [AndroidManifest](./AndroidManifest.xml)

Приложение имеет русскую [локализацию](./res/values-ru/strings.xml).
### Приложение в работе можно посмотреть на [видео](./Video.mp4).

---